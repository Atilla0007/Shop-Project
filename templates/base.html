{% load static %}
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="utf-8">
    <title>{% block title %}آیدین شاپ{% endblock %}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="{% static 'css/style.css' %}">
    <link href="https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/akar-icons-fonts"></script>
</head>
<body class="body"
      data-user-authenticated="{% if user.is_authenticated %}true{% else %}false{% endif %}"
      data-user-id="{% if user.is_authenticated %}{{ user.id }}{% endif %}">

<header class="main-header">
    <div class="container nav-container">
        <button id="sidebar-toggle" class="sidebar-toggle" aria-label="باز کردن منو">
            <span></span>
            <span></span>
            <span></span>
        </button>
        <a href="{% url 'home' %}" class="logo">
            <span class="logo-icon">آی</span>
            <span class="logo-text light">آیدین شاپ</span>
        </a>
        <div class="nav-actions">
            <a href="{% url 'cart' %}" class="btn btn-light small">سبد خرید</a>
            {% if user.is_authenticated %}
                <span class="user-name">{{ user.username }}</span>
                <a href="{% url 'logout' %}" class="btn btn-ghost small">خروج</a>
            {% else %}
                <a href="{% url 'login' %}" class="btn btn-outline small">ورود</a>
                <a href="{% url 'signup' %}" class="btn btn-primary small">ثبت نام</a>
            {% endif %}
        </div>
    </div>
</header>

<div id="sidebar-overlay" class="sidebar-overlay"></div>
<aside id="app-sidebar" class="sidebar">
    <header class="sidebar-header">
        <div class="sidebar-brand">
            <span class="logo-icon">آی</span>
            <div class="brand-text">
                <div class="brand-title">آیدین شاپ</div>
                <div class="brand-subtitle">مسیر خرید راحت</div>
            </div>
        </div>
        <button id="sidebar-close" class="sidebar-close-btn" aria-label="بستن منو">×</button>
    </header>
    <ul>
        <li>
            <button type="button" onclick="gotoPage(this)" data-url="{% url 'home' %}" class="active">
                <i class="ai-home"></i>
                <p>خانه</p>
            </button>
        </li>
        <li>
            <button type="button" onclick="gotoPage(this)" data-url="{% url 'shop' %}">
                <i class="ai-cart"></i>
                <p>فروشگاه</p>
            </button>
        </li>
        <li>
            <button type="button" onclick="gotoPage(this)" data-url="{% url 'news_list' %}">
                <i class="ai-broadcast"></i>
                <p>اخبار</p>
            </button>
        </li>
        <li>
            <button type="button" onclick="gotoPage(this)" data-url="{% url 'faq' %}">
                <i class="ai-question"></i>
                <p>سوالات متداول</p>
            </button>
        </li>
        <li>
            <button type="button" onclick="gotoPage(this)" data-url="{% url 'contact' %}">
                <i class="ai-phone"></i>
                <p>تماس با ما</p>
            </button>
        </li>
        {% if user.is_staff %}
        <li>
            <button type="button" onclick="gotoPage(this)" data-url="{% url 'admin_chat' %}">
                <i class="ai-chat"></i>
                <p>پنل چت ادمین</p>
            </button>
        </li>
        {% endif %}
    </ul>
    <div class="sidebar-spacer" aria-hidden="true"></div>
</aside>

<main>
    {% block content %}{% endblock %}
</main>

<footer class="main-footer">
    <div class="container footer-top">
        <div class="footer-brand">
            <h4>А?Д?А?Д?Б? А?А?Б?</h4>
            <p>Б?А?Б?А? А?А?АФАФД? А?А?Б?Д?АЩА?А? А?А?Б?АЩА?А?Б?Б? АФБ?А?А?Д? А?А? Б?А?А?Д?А?А?Б?Д? Б?А?Б?А?Д?.</p>
        </div>
        <div class="footer-column">
            <h4>А?А?А?А?А?Д? А?А?Д?А?</h4>
            <a href="{% url 'shop' %}">Б?А?Б?А?Ц?А?Б?</a>
            <a href="{% url 'news_list' %}">А?А?А?А?А?</a>
            <a href="{% url 'faq' %}">А?Б?А?Б?А?А? Б?А?А?А?Б?Б?</a>
        </div>
        <div class="footer-column">
            <h4>А?А?Б?А?А?</h4>
            <a href="{% url 'contact' %}">А?А?А?Б?А?А?А? Б?А?А?Б?А?Б?</a>
            <a href="{% url 'contact' %}">Ц?А?А?А?Б?А?Д? Б? А?А?Б?А?А? Б?А? А?АЩ Б?А?Б?А?</a>
        </div>
        <div class="footer-column">
            <h4>А?А?А?А?А?АЗ</h4>
            <p>А?Б?Б?Б?: ДЬДЩД?-xxxxxxx</p>
            <p>А?Д?Б?Д?Б?: info@example.com</p>
        </div>
    </div>
    <div class="container footer-bottom">
        <p>≥? А?Б?А?Б?Д? А?Б?Б?Б? А?А?А?Д? А?Д?А?Д?Б? А?А?Б? Б?А?Б?Б?А? А?А?А?.</p>
    </div>
</footer>

<!-- А?Ц?Б?Б? Ц?А? А?Б?А?Б?А? -->
{% if user.is_authenticated %}
<div id="global-chat-toggle" class="floating-chat-btn">
    Я???
</div>

<!-- Б?Б?Б? Ц?А? А?Б?А?Б?А? -->
<div id="global-chat-widget" class="global-chat hidden">
    <div class="global-chat-header">
        <span>Ц?А? А?Б?Б?А?Д?Б? А?А? Б?А?А?Д?А?А?Б?</span>
        <button type="button" id="global-chat-close" class="close-btn"> ?</button>
    </div>
    <div id="global-chat-messages" class="global-chat-messages">
        <!-- Б?Д?А?Б?┐??Б?А? А?Д?Б?А?А? Б?Б?А?Д?А? А?А?А?Б? Б?Д?┐??А?Б?Б?А? -->
    </div>
    <form id="global-chat-form" class="global-chat-form">
        {% csrf_token %}
        <input id="global-chat-input" type="text" placeholder="Б?Д?А?Б? А?Б?А? А?А? А?Б?Б?Д?А?Д?А?..." autocomplete="off">
        <button type="submit">А?А?А?А?Б?</button>
    </form>
</div>
{% endif %}

<!-- JavaScript -->
<script src="https://cdn.socket.io/4.7.5/socket.io.min.js" crossorigin="anonymous"></script>
<script src="{% static 'js/chat.js' %}"></script>
<script src="{% static 'js/sidebar.js' %}"></script>
<script src="{% static 'js/theme.js' %}"></script>
{% block extra_js %}{% endblock %}
</body>
</html>
